var L=(a,t,e)=>new Promise((r,s)=>{var x=u=>{try{y(e.next(u))}catch(p){s(p)}},N=u=>{try{y(e.throw(u))}catch(p){s(p)}},y=u=>u.done?r(u.value):Promise.resolve(u.value).then(x,N);y((e=e.apply(a,t)).next())});import{c as o,I as C,d as se,r as f,a as le,b as oe,e as O,f as v,F as ie,g as ue,w as m,h as w,u as ce,o as h,n as de,t as b,i as X,j as P,k,l as Y,E as q,_ as fe}from"./index-NR2WY3fU.js";import{a as K}from"./axios-CRHN5D_a.js";var ve={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"};function G(a){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},r=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),r.forEach(function(s){me(a,s,e[s])})}return a}function me(a,t,e){return t in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}var I=function(t,e){var r=G({},t,e.attrs);return o(C,G({},r,{icon:ve}),null)};I.displayName="LockOutlined";I.inheritAttrs=!1;var pe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0068.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"}}]},name:"mail",theme:"outlined"};function Q(a){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},r=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),r.forEach(function(s){ge(a,s,e[s])})}return a}function ge(a,t,e){return t in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}var H=function(t,e){var r=Q({},t,e.attrs);return o(C,Q({},r,{icon:pe}),null)};H.displayName="MailOutlined";H.inheritAttrs=!1;var he={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64L128 192v384c0 212.1 171.9 384 384 384s384-171.9 384-384V192L512 64zm312 512c0 172.3-139.7 312-312 312S200 748.3 200 576V246l312-110 312 110v330z"}},{tag:"path",attrs:{d:"M378.4 475.1a35.91 35.91 0 00-50.9 0 35.91 35.91 0 000 50.9l129.4 129.4 2.1 2.1a33.98 33.98 0 0048.1 0L730.6 434a33.98 33.98 0 000-48.1l-2.8-2.8a33.98 33.98 0 00-48.1 0L483 579.7 378.4 475.1z"}}]},name:"safety",theme:"outlined"};function W(a){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},r=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),r.forEach(function(s){be(a,s,e[s])})}return a}function be(a,t,e){return t in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}var F=function(t,e){var r=W({},t,e.attrs);return o(C,W({},r,{icon:he}),null)};F.displayName="SafetyOutlined";F.inheritAttrs=!1;var _e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M858.5 763.6a374 374 0 00-80.6-119.5 375.63 375.63 0 00-119.5-80.6c-.4-.2-.8-.3-1.2-.5C719.5 518 760 444.7 760 362c0-137-111-248-248-248S264 225 264 362c0 82.7 40.5 156 102.8 201.1-.4.2-.8.3-1.2.5-44.8 18.9-85 46-119.5 80.6a375.63 375.63 0 00-80.6 119.5A371.7 371.7 0 00136 901.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8 2-77.2 33-149.5 87.8-204.3 56.7-56.7 132-87.9 212.2-87.9s155.5 31.2 212.2 87.9C779 752.7 810 825 812 902.2c.1 4.4 3.6 7.8 8 7.8h60a8 8 0 008-8.2c-1-47.8-10.9-94.3-29.5-138.2zM512 534c-45.9 0-89.1-17.9-121.6-50.4S340 407.9 340 362c0-45.9 17.9-89.1 50.4-121.6S466.1 190 512 190s89.1 17.9 121.6 50.4S684 316.1 684 362c0 45.9-17.9 89.1-50.4 121.6S557.9 534 512 534z"}}]},name:"user",theme:"outlined"};function Z(a){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},r=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),r.forEach(function(s){ye(a,s,e[s])})}return a}function ye(a,t,e){return t in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}var T=function(t,e){var r=Z({},t,e.attrs);return o(C,Z({},r,{icon:_e}),null)};T.displayName="UserOutlined";T.inheritAttrs=!1;const Oe=a=>L(void 0,null,function*(){try{return yield K.post("/v1/auth/userLogin",JSON.stringify(a))}catch(t){throw console.error("请求数据异常:",t),t}}),we=a=>L(void 0,null,function*(){try{return yield K.post("/v1/auth/registerUser",JSON.stringify(a))}catch(t){throw console.error("请求数据异常:",t),t}}),Pe={class:"auth-container"},Se={class:"auth-background"},Me={class:"particles-container"},$e={class:"auth-content"},ze={class:"card-header"},xe={class:"card-title"},Ve={class:"card-subtitle"},je={key:0,class:"error-message"},Ee={key:0,class:"error-message"},Le={key:0,class:"error-message"},ke={key:0,class:"error-message"},Ce={class:"form-footer"},Ne={class:"auth-switch"},Ue={key:0,class:"form-error"},Ae=se({__name:"Auth",setup(a){const t=ce(),e=f(!0),r=f(""),s=f(""),x=f(""),N=f(""),y=f(!1),u=f(!1),p=f(""),S=f(""),M=f(""),$=f(""),z=f(""),i=f(!1),l=le({username:r,password:s,confirmPassword:x,email:N}),V=()=>l.username?l.username.length<3?(p.value=i.value?"用户名不能少于3个字符":"",!1):(p.value="",!0):(p.value=i.value?"用户名不能为空":"",!1),j=()=>l.password?l.password.length<6?(S.value=i.value?"密码不能少于6个字符":"",!1):(S.value="",!0):(S.value=i.value?"密码不能为空":"",!1),U=()=>l.confirmPassword?l.confirmPassword!==l.password?(M.value=i.value?"两次输入的密码不一致":"",!1):(M.value="",!0):(M.value=i.value?"请确认密码":"",!1),A=()=>{if(!l.email&&!e.value)return $.value=i.value?"邮箱不能为空":"",!1;const c=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return!e.value&&!c.test(l.email)?($.value=i.value?"请输入有效的邮箱地址":"",!1):($.value="",!0)},J=oe(()=>e.value?V()&&j():V()&&j()&&U()&&A()),R=c=>{y.value=c},ee=()=>{e.value=!e.value,z.value="",s.value="",x.value="",p.value="",S.value="",M.value="",$.value="",i.value=!1},te=()=>L(this,null,function*(){if(z.value="",i.value=!0,V(),j(),e.value||(U(),A()),!J.value){z.value="请正确填写所有必填项";return}if(e.value)try{u.value=!0;const c=yield Oe({username:l.username,password:l.password}),{data:{successful:n,resultHint:_,resultValue:g}}=c;if(!n)return q({message:_,type:"error"});localStorage.setItem("Authorization",g),t.push("/")}catch(c){console.log(c)}finally{u.value=!1}else try{u.value=!0;const c=yield we({username:l.username,password:l.password,email:l.email}),{data:{successful:n,resultHint:_}}=c;if(!n)return _;q({message:"注册成功，请登录",type:"success"})}catch(c){console.log(c)}finally{e.value=!0,s.value="",u.value=!1}}),ae=c=>{const n=Math.floor(Math.random()*20)+10,_=Math.random()*100,g=Math.random()*100,E=Math.floor(Math.random()*20)+10,D=Math.random()*5,B=Math.random()*.5+.1;return{width:`${n}px`,height:`${n}px`,left:`${_}%`,top:`${g}%`,animationDuration:`${E}s`,animationDelay:`${D}s`,opacity:B}};return(c,n)=>{const _=w("a-input"),g=w("a-form-item"),E=w("a-input-password"),D=w("a-button"),B=w("a-alert"),re=w("a-form"),ne=w("a-card");return h(),O("div",Pe,[v("div",Se,[v("div",Me,[(h(),O(ie,null,ue(20,d=>v("div",{key:d,class:"particle",style:de(ae())},null,4)),64))])]),v("div",$e,[o(ne,{class:"auth-card",bordered:!1},{default:m(()=>[v("div",ze,[n[8]||(n[8]=v("div",{class:"logo-container"},[v("div",{class:"logo-text"})],-1)),v("h1",xe,b(e.value?"欢迎回来":"创建账号"),1),v("p",Ve,b(e.value?"登录您的账号以继续":"填写以下信息创建您的账号"),1)]),o(re,{model:l,class:"login-form",onFinish:te},{default:m(()=>[o(g,null,{default:m(()=>[o(_,{value:l.username,"onUpdate:value":n[0]||(n[0]=d=>l.username=d),placeholder:"请输入用户名",size:"large",onInput:n[1]||(n[1]=d=>i.value&&V)},{prefix:m(()=>[o(k(T),{class:"site-form-item-icon"})]),_:1},8,["value"]),p.value?(h(),O("div",je,b(p.value),1)):P("",!0)]),_:1}),o(g,null,{default:m(()=>[o(E,{value:l.password,"onUpdate:value":n[2]||(n[2]=d=>l.password=d),placeholder:"密码",size:"large",onInput:n[3]||(n[3]=d=>i.value&&j),visibilityToggle:!0,visible:y.value,onVisibilityChange:R},{prefix:m(()=>[o(k(I),{class:"site-form-item-icon"})]),_:1},8,["value","visible"]),S.value?(h(),O("div",Ee,b(S.value),1)):P("",!0)]),_:1}),e.value?P("",!0):(h(),X(g,{key:0},{default:m(()=>[o(E,{value:l.confirmPassword,"onUpdate:value":n[4]||(n[4]=d=>l.confirmPassword=d),placeholder:"确认密码",size:"large",onInput:n[5]||(n[5]=d=>i.value&&U),visibilityToggle:!0,visible:y.value,onVisibilityChange:R},{prefix:m(()=>[o(k(F),{class:"site-form-item-icon"})]),_:1},8,["value","visible"]),M.value?(h(),O("div",Le,b(M.value),1)):P("",!0)]),_:1})),e.value?P("",!0):(h(),X(g,{key:1},{default:m(()=>[o(_,{value:l.email,"onUpdate:value":n[6]||(n[6]=d=>l.email=d),placeholder:"邮箱地址",size:"large",onInput:n[7]||(n[7]=d=>i.value&&A)},{prefix:m(()=>[o(k(H),{class:"site-form-item-icon"})]),_:1},8,["value"]),$.value?(h(),O("div",ke,b($.value),1)):P("",!0)]),_:1})),o(g,null,{default:m(()=>[o(D,{type:"primary","html-type":"submit",class:"login-form-button",disabled:!J.value,size:"large",loading:u.value},{default:m(()=>[Y(b(e.value?"登录":"注册"),1)]),_:1},8,["disabled","loading"])]),_:1}),v("div",Ce,[v("div",Ne,[Y(b(e.value?"还没有账号？":"已有账号？")+" ",1),v("a",{class:"switch-link",onClick:ee},b(e.value?"立即注册":"去登录"),1)]),z.value?(h(),O("div",Ue,[o(B,{message:z.value,type:"error","show-icon":""},null,8,["message"])])):P("",!0)])]),_:1},8,["model"])]),_:1})]),n[9]||(n[9]=v("div",{class:"auth-footer"},null,-1))])}}}),He=fe(Ae,[["__scopeId","data-v-74fbf84a"]]);export{He as default};
