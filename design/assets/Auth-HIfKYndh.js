var L=(a,t,e)=>new Promise((n,l)=>{var $=u=>{try{b(e.next(u))}catch(p){l(p)}},C=u=>{try{b(e.throw(u))}catch(p){l(p)}},b=u=>u.done?n(u.value):Promise.resolve(u.value).then($,C);b((e=e.apply(a,t)).next())});import{c as o,I as A,d as re,r as v,a as se,b as ne,e as w,f,F as le,g as oe,w as m,h as O,u as ie,o as h,n as ue,t as _,i as R,j as P,k as E,l as X,E as Y,_ as ce}from"./index-D3AlzqxX.js";import{a as W,U as de}from"./axios-T7t-lN1I.js";var ve={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"};function q(a){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},n=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(e).filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable}))),n.forEach(function(l){fe(a,l,e[l])})}return a}function fe(a,t,e){return t in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}var B=function(t,e){var n=q({},t,e.attrs);return o(A,q({},n,{icon:ve}),null)};B.displayName="LockOutlined";B.inheritAttrs=!1;var me={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0068.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"}}]},name:"mail",theme:"outlined"};function G(a){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},n=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(e).filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable}))),n.forEach(function(l){pe(a,l,e[l])})}return a}function pe(a,t,e){return t in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}var H=function(t,e){var n=G({},t,e.attrs);return o(A,G({},n,{icon:me}),null)};H.displayName="MailOutlined";H.inheritAttrs=!1;var ge={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64L128 192v384c0 212.1 171.9 384 384 384s384-171.9 384-384V192L512 64zm312 512c0 172.3-139.7 312-312 312S200 748.3 200 576V246l312-110 312 110v330z"}},{tag:"path",attrs:{d:"M378.4 475.1a35.91 35.91 0 00-50.9 0 35.91 35.91 0 000 50.9l129.4 129.4 2.1 2.1a33.98 33.98 0 0048.1 0L730.6 434a33.98 33.98 0 000-48.1l-2.8-2.8a33.98 33.98 0 00-48.1 0L483 579.7 378.4 475.1z"}}]},name:"safety",theme:"outlined"};function Q(a){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},n=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(n=n.concat(Object.getOwnPropertySymbols(e).filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable}))),n.forEach(function(l){he(a,l,e[l])})}return a}function he(a,t,e){return t in a?Object.defineProperty(a,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):a[t]=e,a}var F=function(t,e){var n=Q({},t,e.attrs);return o(A,Q({},n,{icon:ge}),null)};F.displayName="SafetyOutlined";F.inheritAttrs=!1;const _e=a=>L(void 0,null,function*(){try{return yield W.post("/v1/auth/userLogin",JSON.stringify(a))}catch(t){throw console.error("请求数据异常:",t),t}}),ye=a=>L(void 0,null,function*(){try{return yield W.post("/v1/auth/registerUser",JSON.stringify(a))}catch(t){throw console.error("请求数据异常:",t),t}}),be={class:"auth-container"},we={class:"auth-background"},Oe={class:"particles-container"},Pe={class:"auth-content"},Se={class:"card-header"},Me={class:"card-title"},ze={class:"card-subtitle"},Ve={key:0,class:"error-message"},$e={key:0,class:"error-message"},xe={key:0,class:"error-message"},ke={key:0,class:"error-message"},je={class:"form-footer"},Le={class:"auth-switch"},Ee={key:0,class:"form-error"},Ce=re({__name:"Auth",setup(a){const t=ie(),e=v(!0),n=v(""),l=v(""),$=v(""),C=v(""),b=v(!1),u=v(!1),p=v(""),S=v(""),M=v(""),z=v(""),V=v(""),i=v(!1),s=se({username:n,password:l,confirmPassword:$,email:C}),x=()=>s.username?s.username.length<3?(p.value=i.value?"用户名不能少于3个字符":"",!1):(p.value="",!0):(p.value=i.value?"用户名不能为空":"",!1),k=()=>s.password?s.password.length<6?(S.value=i.value?"密码不能少于6个字符":"",!1):(S.value="",!0):(S.value=i.value?"密码不能为空":"",!1),N=()=>s.confirmPassword?s.confirmPassword!==s.password?(M.value=i.value?"两次输入的密码不一致":"",!1):(M.value="",!0):(M.value=i.value?"请确认密码":"",!1),D=()=>{if(!s.email&&!e.value)return z.value=i.value?"邮箱不能为空":"",!1;const c=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return!e.value&&!c.test(s.email)?(z.value=i.value?"请输入有效的邮箱地址":"",!1):(z.value="",!0)},T=ne(()=>e.value?x()&&k():x()&&k()&&N()&&D()),J=c=>{b.value=c},Z=()=>{e.value=!e.value,V.value="",l.value="",$.value="",p.value="",S.value="",M.value="",z.value="",i.value=!1},K=()=>L(this,null,function*(){if(V.value="",i.value=!0,x(),k(),e.value||(N(),D()),!T.value){V.value="请正确填写所有必填项";return}if(e.value)try{u.value=!0;const c=yield _e({username:s.username,password:s.password}),{data:{successful:r,resultHint:y,resultValue:g}}=c;if(!r)return Y({message:y,type:"error"});localStorage.setItem("Authorization",g),t.push("/")}catch(c){console.log(c)}finally{u.value=!1}else try{u.value=!0;const c=yield ye({username:s.username,password:s.password,email:s.email}),{data:{successful:r,resultHint:y}}=c;if(!r)return y;Y({message:"注册成功，请登录",type:"success"})}catch(c){console.log(c)}finally{e.value=!0,l.value="",u.value=!1}}),ee=c=>{const r=Math.floor(Math.random()*20)+10,y=Math.random()*100,g=Math.random()*100,j=Math.floor(Math.random()*20)+10,I=Math.random()*5,U=Math.random()*.5+.1;return{width:`${r}px`,height:`${r}px`,left:`${y}%`,top:`${g}%`,animationDuration:`${j}s`,animationDelay:`${I}s`,opacity:U}};return(c,r)=>{const y=O("a-input"),g=O("a-form-item"),j=O("a-input-password"),I=O("a-button"),U=O("a-alert"),te=O("a-form"),ae=O("a-card");return h(),w("div",be,[f("div",we,[f("div",Oe,[(h(),w(le,null,oe(20,d=>f("div",{key:d,class:"particle",style:ue(ee())},null,4)),64))])]),f("div",Pe,[o(ae,{class:"auth-card",bordered:!1},{default:m(()=>[f("div",Se,[r[8]||(r[8]=f("div",{class:"logo-container"},[f("div",{class:"logo-text"})],-1)),f("h1",Me,_(e.value?"欢迎回来":"创建账号"),1),f("p",ze,_(e.value?"登录您的账号以继续":"填写以下信息创建您的账号"),1)]),o(te,{model:s,class:"login-form",onFinish:K},{default:m(()=>[o(g,null,{default:m(()=>[o(y,{value:s.username,"onUpdate:value":r[0]||(r[0]=d=>s.username=d),placeholder:"请输入用户名",size:"large",onInput:r[1]||(r[1]=d=>i.value&&x)},{prefix:m(()=>[o(E(de),{class:"site-form-item-icon"})]),_:1},8,["value"]),p.value?(h(),w("div",Ve,_(p.value),1)):P("",!0)]),_:1}),o(g,null,{default:m(()=>[o(j,{value:s.password,"onUpdate:value":r[2]||(r[2]=d=>s.password=d),placeholder:"密码",size:"large",onInput:r[3]||(r[3]=d=>i.value&&k),visibilityToggle:!0,visible:b.value,onVisibilityChange:J},{prefix:m(()=>[o(E(B),{class:"site-form-item-icon"})]),_:1},8,["value","visible"]),S.value?(h(),w("div",$e,_(S.value),1)):P("",!0)]),_:1}),e.value?P("",!0):(h(),R(g,{key:0},{default:m(()=>[o(j,{value:s.confirmPassword,"onUpdate:value":r[4]||(r[4]=d=>s.confirmPassword=d),placeholder:"确认密码",size:"large",onInput:r[5]||(r[5]=d=>i.value&&N),visibilityToggle:!0,visible:b.value,onVisibilityChange:J},{prefix:m(()=>[o(E(F),{class:"site-form-item-icon"})]),_:1},8,["value","visible"]),M.value?(h(),w("div",xe,_(M.value),1)):P("",!0)]),_:1})),e.value?P("",!0):(h(),R(g,{key:1},{default:m(()=>[o(y,{value:s.email,"onUpdate:value":r[6]||(r[6]=d=>s.email=d),placeholder:"邮箱地址",size:"large",onInput:r[7]||(r[7]=d=>i.value&&D)},{prefix:m(()=>[o(E(H),{class:"site-form-item-icon"})]),_:1},8,["value"]),z.value?(h(),w("div",ke,_(z.value),1)):P("",!0)]),_:1})),o(g,null,{default:m(()=>[o(I,{type:"primary","html-type":"submit",class:"login-form-button",disabled:!T.value,size:"large",loading:u.value},{default:m(()=>[X(_(e.value?"登录":"注册"),1)]),_:1},8,["disabled","loading"])]),_:1}),f("div",je,[f("div",Le,[X(_(e.value?"还没有账号？":"已有账号？")+" ",1),f("a",{class:"switch-link",onClick:Z},_(e.value?"立即注册":"去登录"),1)]),V.value?(h(),w("div",Ee,[o(U,{message:V.value,type:"error","show-icon":""},null,8,["message"])])):P("",!0)])]),_:1},8,["model"])]),_:1})]),r[9]||(r[9]=f("div",{class:"auth-footer"},null,-1))])}}}),Ue=ce(Ce,[["__scopeId","data-v-86d07592"]]);export{Ue as default};
